# 椭圆型方程的有限差分法

本部分内容主要讨论椭圆型偏微分方程的有限差分数值解法，包括区域离散化、差分格式构造、解的存在唯一性、稳定性及收敛性分析，并通过一维边值问题实例说明具体实现步骤。

> 这一节只是一个初步，应该内容不算很重要。

---

## 目录
- [椭圆型方程的有限差分法](#椭圆型方程的有限差分法)
  - [目录](#目录)
  - [椭圆型方程简介](#椭圆型方程简介)
  - [差分逼近的基本概念](#差分逼近的基本概念)
    - [区域离散](#区域离散)
    - [离散化与差分格式](#离散化与差分格式)
    - [截断误差](#截断误差)
  - [存在唯一性、稳定性及收敛性](#存在唯一性稳定性及收敛性)
    - [存在唯一性证明](#存在唯一性证明)
    - [范数的定义与意义](#范数的定义与意义)
    - [相容性条件](#相容性条件)
    - [稳定性定义与解释](#稳定性定义与解释)
    - [收敛性定理](#收敛性定理)
  - [实例：一维边值问题的差分格式](#实例一维边值问题的差分格式)
  - [总结](#总结)

---

## 椭圆型方程简介

椭圆型方程描述定常态物理现象，如平衡问题、位势场分布等。典型方程包括：
1. **Laplace 方程**：
   \[
   -\Delta u = -\left( \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} \right) = 0
   \]
2. **Poisson 方程**：
   \[
   -\Delta u = f(x, y)
   \]
3. **双调和方程**：
   \[
   \Delta^2 u = \frac{\partial^4 u}{\partial x^4} + 2 \frac{\partial^4 u}{\partial x^2 \partial y^2} + \frac{\partial^4 u}{\partial y^4} = 0
   \]

**边界条件类型**：
- **Dirichlet**：\( u|_{\partial \Omega} = \alpha(x, y) \)（直接指定边界值）
- **Neumann**：\( \frac{\partial u}{\partial n}|_{\partial \Omega} = \beta(x, y) \)（指定边界法向导数）
- **Robin**：\( \frac{\partial u}{\partial n}|_{\partial \Omega} + ku|_{\partial \Omega} = \gamma(x, y) \)（混合边界条件）

---

## 差分逼近的基本概念

### 区域离散
- **一维情形**：将区间 \([a, b]\) 分为 \(N\) 等分，节点为：
  \[
  x_i = a + ih, \quad h = \frac{b-a}{N}, \quad i = 0, 1, \dots, N
  \]
  每个小区间称为单元，步长 \(h\) 决定离散精度。
- **二维情形**：将区域划分为均匀或非均匀的矩形或三角形网格。例如，矩形网格节点坐标为 \((x_i, y_j)\)。

### 离散化与差分格式
对二阶导数进行泰勒展开，得到中心差分近似：
\[
\frac{u(x_{i+1}) - 2u(x_i) + u(x_{i-1})}{h^2} = u''(x_i) + \frac{h^2}{12}u^{(4)}(x_i) + O(h^3)
\]
将微分方程离散为差分方程：
\[
L_h u_i = -\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} + q_i u_i = f_i \quad (i = 1, 2, \dots, N-1)
\]
边界条件直接代入：\( u_0 = \alpha, \, u_N = \beta \)。

### 截断误差
舍去高阶项后，差分方程的截断误差为：
\[
R_i(u) = -\frac{h^2}{12}u^{(4)}(x_i) + O(h^3) = O(h^2)
\]
表明当 \(h \to 0\) 时，差分格式以二阶精度逼近原微分方程。

---

## 存在唯一性、稳定性及收敛性

### 存在唯一性证明
**严格对角占优矩阵**：若矩阵 \(A\) 满足每行对角元的绝对值大于该行其他元素绝对值之和，即：
\[
|A_{ii}| > \sum_{j \neq i} |A_{ij}| \quad (\forall i)
\]
则 \(A\) 可逆，方程组 \(AU = F\) 存在唯一解。

**应用**：差分方程的系数矩阵 \(A\) 中，对角元为 \(\frac{2}{h^2} + q_i\)，非对角元为 \(-\frac{1}{h^2}\)。当 \(q_i \geq 0\) 时，满足：
\[
\left|\frac{2}{h^2} + q_i\right| > \frac{2}{h^2} \quad \Rightarrow \quad A \text{ 严格对角占优}
\]
因此，差分方程组存在唯一解。

### 范数的定义与意义
为分析误差和稳定性，引入网格函数范数：
1. **最大范数**：衡量节点值的最大偏差
   \[
   \|u_h\|_{\infty} = \max_{x_i \in I_h} |u_i|
   \]
2. **L²范数**：离散积分的平方根，反映整体误差
   \[
   \|u_h\|_0^2 = \sum_{x_i \in I_h} h u_i^2
   \]
3. **H¹范数**：包含函数值及其导数的能量范数
   \[
   \|u_h\|_1^2 = \|u_h\|_0^2 + |u_h|_1^2, \quad |u_h|_1^2 = \sum_{x_i \in I_h} h \left( \frac{u_i - u_{i-1}}{h} \right)^2
   \]
不同范数用于不同分析场景，例如：
- \(\|\cdot\|_{\infty}\) 用于逐点误差控制
- \(\|\cdot\|_1\) 用于能量稳定性分析

### 相容性条件
差分算子 \(L_h\) 逼近微分算子 \(L\)，需满足：
\[
\lim_{h \to 0} \|R_h(u)\| = 0
\]
其中截断误差的范数阶为：
\[
\|R_h(u)\|_{\infty} = O(h^2), \quad \|R_h(u)\|_0 = O(h^2), \quad \|R_h(u)\|_1 = O(h)
\]
**意义**：当网格细化时，离散方程逐渐逼近原方程，保证格式的准确性。

### 稳定性定义与解释
差分方程关于右端项稳定，若存在常数 \(M\) 使得：
\[
\|v_h\| \leq M \|f_h\|_R \quad (0 < h \leq h_0)
\]
其中 \(v_h\) 为差分方程的解，\(f_h\) 为右端项。

**实际意义**：
- 稳定性确保右端项（如输入数据或舍入误差）的小扰动不会导致解的剧烈变化。
- 若 \(f_h\) 误差为 \(\delta f_h\)，则解误差 \(\delta v_h\) 满足：
  \[
  \|\delta v_h\| \leq M \|\delta f_h\|_R
  \]
  即误差被线性放大，放大因子为 \(M\)。

### 收敛性定理
**定理**：若边值问题的解 \(u\) 充分光滑（如 \(u \in C^4\)），且差分格式满足：
1. **相容性**：截断误差 \(\|R_h(u)\|_R = O(h^2)\)
2. **稳定性**：存在与 \(h\) 无关的常数 \(M\)

则差分解 \(u_h\) 收敛到真解 \(u\)，且收敛阶与截断误差一致：
\[
\|u_h - u\| \leq M \|R_h(u)\|_R = O(h^2)
\]
**解释**：
- **解的光滑性**：保证泰勒展开的高阶项存在，使得截断误差可控。
- **相容性**：确保离散方程正确逼近原方程。
- **稳定性**：将截断误差的积累控制为解的误差。

---

## 实例：一维边值问题的差分格式
考虑方程 \(-\frac{d^2u}{dx^2} + qu = f\)，Dirichlet边界条件 \(u(a)=\alpha, u(b)=\beta\)，取 \(N=5\)，离散后方程组为：
\[
A = 
\begin{pmatrix}
\frac{2}{h^2} + q_1 & -\frac{1}{h^2} & 0 & 0 \\
-\frac{1}{h^2} & \frac{2}{h^2} + q_2 & -\frac{1}{h^2} & 0 \\
0 & -\frac{1}{h^2} & \frac{2}{h^2} + q_3 & -\frac{1}{h^2} \\
0 & 0 & -\frac{1}{h^2} & \frac{2}{h^2} + q_4
\end{pmatrix}, \quad
F = \begin{pmatrix}
f_1 + \frac{\alpha}{h^2} \\
f_2 \\
f_3 \\
f_4 + \frac{\beta}{h^2}
\end{pmatrix}
\]
**关键说明**：
1. **矩阵结构**：三对角矩阵（每个节点仅与相邻节点耦合），适合高效算法（如 Thomas 算法）求解。
2. **右端向量**：边界条件通过 \(\frac{\alpha}{h^2}\) 和 \(\frac{\beta}{h^2}\) 整合到方程中，确保离散系统封闭。

---

## 总结
1. **离散化步骤**：区域剖分 → 差分近似 → 构造线性方程组。
2. **存在唯一性**：严格对角占优矩阵保证系数矩阵可逆。
3. **稳定性与收敛性**：
   - 稳定性确保数值解对扰动的鲁棒性。
   - 相容性 + 稳定性 ⇒ 收敛性，收敛阶由截断误差决定。
4. **实际应用**：三对角矩阵的高效求解方法适用于一维问题，边界条件需显式处理。
