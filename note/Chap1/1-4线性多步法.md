# 多步法

单步法是给出初值就能算的方法，$k+1$步多步法是需要$k+1$个初值的方法。

## 多步法的一般形式

$$u_{n+1}=\sum_{j=0}^k\alpha_ju_{n-1}+\tau\sum_{j=-1}^k\beta_jf(t_{n-j},u_{n-j}) $$

对于$\beta_{-1}\neq 0$，就是隐式法。

> 隐式法迭代收敛的条件：
>
> $\tau|\beta_{-1}|L\lt 1$
>
> 为什么？回忆迭代方程收敛的条件：
> $$x_{k+1}=f(x_k)\text{收敛}\iff |f(x)-f(y)|\leq L |x-y|,L<1 $$

多步法计算用到的信息更多，可能塑造出更高精度的算法。其截断误差$$R_{n+1}(u)=u(t_{n+1})-[\sum_{j=0}^k\alpha u(t_{n-j})+\tau\sum_{j=-1}^k\beta_jf(t_{n-j,u(t_{n-j})})] $$，另外定义$$T_{n+1}(u)=\frac{1}{\tau}R_{n+1}(u) $$，并且令$$\delta(\tau)=\max_{0\leq t\leq T}|T_{n+1}(u)| $$

## 多步法相容性：

相容性条件$$\delta(\tau)\to 0 $$

相容性条件的充要条件$$\sum_{j=0}^k\alpha_j=1 $$$$-\sum_{j=0}^kj\alpha_j+\sum_{j=-1}^k\beta_j=1 $$

事实上，上面两条是$0$阶、$1$阶的条件。如果对于$p$阶方法(定义在下)，其实就是$$\sum_{j=0}^k(-j)^p\alpha_j+p\sum_{j=-1}^k(-j)^{p-1}\beta_j=1 $$

并且小于$p$阶的条件也都必须满足。

> 在下面的待定系数法的Taylor展开叙述中还有另一种叙述。

## 多步法的阶数

对于$$\delta(\tau)=O(\tau^p) $$，就认为方法具有$p$阶。

## 推导高阶多步法的方法

这里给出的是**获得高阶多步法系数的方法**。

有两种，分别是**数值积分法**与**待定系数法**。

### 数值积分法

思想是$$u(t_{n-1})-u(t_n)=\int_{t_n}^{t_{n+1}}f(t,u(t))\text{d}t $$，此时只需要近似出右边的积分就可以。

可以使用$k$次Lagrange插值多项式来近似替代$f$。

#### Admas外插法

又称Admas-Bashorth法，是一种**显式多步法**。

对$f$在$t_{n-k},...,t_{n-1},t_n $处做牛顿向后插值。

首先给出PPT的牛顿插值，其中$T_k$为对应误差项。

![](1-4-1.png)

> 数值分析的格式为$$P_n(x) = f[x_0] + f[x_0, x_1](x - x_0) + \cdots + f[x_0, x_1, \dots, x_n](x - x_0)(x - x_1)\cdots(x - x_{n-1})$$，其中差商的定义为$$f[x_0, x_1, \dots, x_k] = \frac{f[x_1, x_2, \dots, x_k] - f[x_0, x_1, \dots, x_{k-1}]}{x_k - x_0}$$，误差项为$$T_n(x) = f(x) - P_n(x) = f[x_0, x_1, \dots, x_n, x] \cdot \prod_{i=0}^n (x - x_i)\\T_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!} \cdot \prod_{i=0}^n (x - x_i) $$

![](1-4-2.png)

![](1-4-3.png)

![](1-4-4.png)

> Adams 外插公式的局部截断误差阶为$O(\tau^{k+2})$

#### Adams内插法

Admas-Moulton法，是隐式多步法。

与外插法基本相同，只是插值点加上了所求点，因此变成了一个隐式方法。

![](1-4-5.png)

![](1-4-6.png)

> Adams 内插公式的局部截断误差阶为$O(\tau^{k+3})$，比外插法高一阶。

> Adams 内插和外插两者区别：
> (1). 就绝对值系数比较，内插法中舍入误差影响比外插法小。
> (2). 利用的已知量保持一致的情况下，内插法比之高一阶。
> (3). 显式直接解方程，隐式需迭代求解。

事实上，如果修改积分区间，可以构造成其他积分形式。

内插法和外插法的系数可以通过查表得到。

> 注意二步的例子，需要可以查阅[这里](../../ppt/1.4%20线性多步法.pdf)观看ppt中的算例。

### 待定系数法

#### 一般解法

根据之前给出的$k+1$步法$p$阶的相容性条件$$\sum_{j=0}^k\alpha_j=1 $$$$\sum_{j=0}^k(-j)^i\alpha_j+i\sum_{j=-1}^k(-j)^{i-1}\beta_j=1,i=1,2,\dots, p $$。这里面有$2k+3$个待定系数，$p+1$个方程。求出一组解即可。

#### 使用Taylor展开方法

![](1-4-7.png)

![](1-4-8.png)

![](1-4-9.png)

![](1-4-10.png)

> 此处也需要注意能够做二步法。需要可以查阅[这里](../../ppt/1.4%20线性多步法.pdf)观看ppt中的算例。

![](1-4-11.png)

##### 未完
